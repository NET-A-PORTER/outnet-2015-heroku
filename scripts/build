#!/usr/bin/env node --harmony

require('../src/global');

var cli = require('commander');
var utils = base.require('core/utils');
var Style = base.require('controllers/styles/style');

var styles;

cli
  .arguments('<styles...>')
  .action(function (arg) {
    styles = arg
  });

cli.parse(process.argv);

if (typeof styles === 'undefined') {
   console.error('no styles given!');
   process.exit(1);
}

utils.yield(function * main() {
  var styleDir	= base.path('styles');
  for (styleDetails of styles) {
    var style = new Style(styleDetails, styleDir);
    yield * style.build();
    for (elementName of (yield style.getDefinition()).elements) {
      yield * style.getElement(elementName);
    }
    console.log('Generated', styleDetails);
  }
});
